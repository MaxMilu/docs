<!DOCTYPE html>

<html>
<head>
<title>Advanced Functions - Manipulate Page URL in Event Func - My Document</title>

<meta name='description'>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<base href='/docs/'>

<link href='index.css' rel='stylesheet' type='text/css'>

<script type='text/javascript' defer src='index.js'></script>
</head>

<body>
<div id='app' v-cloak>
<div v-init-context:vars='{hideAside: false}' class='flex h-screen'>
<div class='flex-1 flex flex-col overflow-hidden'>
<div class='flex h-full'>
<aside v-show='!vars.hideAside' class='flex flex-col w-80 h-full bg-gray-50 border-r border-gray-200 overflow-y-auto'>
<div class='h-12'><search></search></div>

<ul class='px-0 mx-0 text-base font-normal list-none text-gray-700'>
<li>
<a href='index.html' class='inline-block px-4 truncate break-words w-64 text-gray-700'>Introduction</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Getting Started</li>

<li>
<a href='getting-started/one-minute-quick-start.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>1 Minute Quick Start</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Basics</li>

<li>
<a href='basics/listing.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Listing Page</a>
</li>

<li>
<a href='basics/filter.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Filters</a>
</li>

<li>
<a href='presets-guide/editing-customizations.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Editing Customizations</a>
</li>

<li>
<a href='basics/form-handling.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Form Handling</a>
</li>

<li>
<a href='vuetify-components/basic-inputs.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Basic Inputs</a>
</li>

<li>
<a href='vuetify-components/auto-complete.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Auto Complete</a>
</li>

<li>
<a href='basics/shortcut.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Keyboard Shortcut</a>
</li>

<li>
<a href='vuetify-components/variant-sub-form.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Variant Sub Form</a>
</li>

<li>
<a href='vuetify-components/linkage-select.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Linkage Select</a>
</li>

<li>
<a href='presets-guide/permissions.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Permissions</a>
</li>

<li>
<a href='basics/notification-center.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Notification Center</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Advanced Functions</li>

<li>
<a href='basics/page-func-and-event-func.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Page Func and Event Func</a>
</li>

<li>
<a href='advanced-functions/the-go-html-builder.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>The Go HTML builder</a>
</li>

<li>
<a href='vuetify-components/a-taste-of-using-vuetify-in-go.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>A Taste of using Vuetify in Go</a>
</li>

<li>
<a href='presets-guide/its-the-whole-house.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Not just scaffolding, it&#39;s the whole house</a>
</li>

<li>
<a href='vuetify-components/navigation-drawer.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Navigation Drawer</a>
</li>

<li>
<a href='vuetify-components/lazy-portals.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Lazy Portals</a>
</li>

<li>
<a href='basics/layout-function-and-page-injector.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Layout Function and Page Injector</a>
</li>

<li>
<a href='basics/switch-pages-with-push-state.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Switch Pages with Push State</a>
</li>

<li>
<a href='basics/reload-page-with-a-flash.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Reload Page with a Flash</a>
</li>

<li>
<a href='basics/partial-refresh-with-portal.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Partial Refresh with Portal</a>
</li>

<li>
<a href='basics/manipulate-page-url-in-event-func.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-blue-500'>Manipulate Page URL in Event Func</a>
</li>

<li>
<a href='basics/summary-of-event-response.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Summary of Event Response</a>
</li>

<li>
<a href='basics/scope-component.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Scope Component</a>
</li>

<li>
<a href='basics/event-handling.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Event Handling</a>
</li>

<li>
<a href='presets-guide/detail-page-for-complex-object.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Detail page for complex object</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Digging Deeper</li>

<li>
<a href='components-guide/composite-new-component-with-go.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Composite new Component With Go</a>
</li>

<li>
<a href='components-guide/integrate-a-heavy-vue-component.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Integrate a heavy Vue Component</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Appendix</li>

<li>
<a href='appendix/all-demo-examples.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>All Demo Examples</a>
</li>
</ul>
</aside>

<main class='flex flex-col w-full bg-white overflow-x-hidden overflow-y-auto'>
<div id='docContentBox' class='flex flex-row w-full'>
<div class='flex flex-grow flex-col w-2/3'>
<div class='flex flex-row'>
<button @click='vars.hideAside = !vars.hideAside' class='w-12 h-12 p-4'>
<div class='w-4 h-4 fill-current text-gray-300'>
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 2 12 L 2 11 L 14 11 L 14 12 Z M 2 8.5 L 2 7.5 L 14 7.5 L 14 8.5 Z M 2 5 L 2 4 L 14 4 L 14 5 Z M 2 5 "/>
</g>
</svg>
</div>
</button>
</div>

<div id='docMainBox' class='px-16 pb-12 pt-4 overflow-auto'>
<h1 class='mb-8'>Manipulate Page URL in Event Func</h1>

<div class='border-t'><p>Encode page state into query strings in url is useful. because user can paste the link to another person,
That can open the page to the exact state of the page being sent, Not the initial state of the page.</p>

<p>For example:</p>

<highlightjs :language='"go"' :code='"import (\n\t\"net/url\"\n\n\t\"github.com/goplaid/web\"\n\t. \"github.com/theplant/htmlgo\"\n)\n\nfunc MultiStatePage(ctx *web.EventContext) (pr web.PageResponse, err error) {\n\n\ttitle := \"Multi State Page\"\n\tif len(ctx.R.URL.Query().Get(\"title\")) \u003e 0 {\n\t\ttitle = ctx.R.URL.Query().Get(\"title\")\n\t}\n\tvar panel HTMLComponent\n\tif len(ctx.R.URL.Query().Get(\"panel\")) \u003e 0 {\n\t\tpanel = Div(\n\t\t\tFieldset(\n\t\t\t\tDiv(\n\t\t\t\t\tLabel(\"Name\"),\n\t\t\t\t\tInput(\"\").Type(\"text\"),\n\t\t\t\t),\n\t\t\t\tDiv(\n\t\t\t\t\tLabel(\"Date\"),\n\t\t\t\t\tInput(\"\").Type(\"date\"),\n\t\t\t\t),\n\t\t\t),\n\t\t\tButton(\"Update\").Attr(\"@click\", web.POST().EventFunc(\"update5\").Go()),\n\t\t).Style(\"border: 5px solid orange; height: 200px;\")\n\t}\n\n\tpr.Body = Div(\n\t\tH1(title),\n\t\tOl(\n\t\t\tLi(\n\t\t\t\tA().Text(\"change page title\").Href(\"javascript:;\").\n\t\t\t\t\tAttr(\"@click\", web.POST().Queries(url.Values{\"title\": []string{\"Hello\"}}).Go()),\n\t\t\t),\n\t\t\tLi(\n\t\t\t\tA().Text(\"show panel\").Href(\"javascript:;\").Attr(\"@click\", web.POST().EventFunc(\"openPanel\").Go()),\n\t\t\t),\n\t\t),\n\t\tpanel,\n\n\t\tTable(\n\t\t\tThead(\n\t\t\t\tTh(\"Name\"),\n\t\t\t\tTh(\"Date\"),\n\t\t\t),\n\t\t\tTbody(\n\t\t\t\tTr(\n\t\t\t\t\tTd(Text(\"Felix\")),\n\t\t\t\t\tTd(Text(\"2019-01-02\")),\n\t\t\t\t),\n\t\t\t),\n\t\t),\n\t)\n\treturn\n}\n\nfunc openPanel(ctx *web.EventContext) (er web.EventResponse, err error) {\n\ter.PushState = web.Location(url.Values{\"panel\": []string{\"1\"}}).MergeQuery(true)\n\treturn\n}\n\nfunc update5(ctx *web.EventContext) (er web.EventResponse, err error) {\n\ter.PushState = web.Location(url.Values{\"panel\": []string{\"\"}}).MergeQuery(true)\n\treturn\n}\n\nvar MultiStatePagePB = web.Page(MultiStatePage).\n\tEventFunc(\"openPanel\", openPanel).\n\tEventFunc(\"update5\", update5)\n\nconst MultiStatePagePath = \"/samples/multi_state_page\"\n"'></highlightjs>

<div>
<div class='demo'>
<a href='/samples/multi_state_page' target='_blank'>Check the demo</a>
 | 
<a href='https://github.com/qor5/docs/tree/master/examples/e00_basics/manipulate-page-url.go' target='_blank'>Source on GitHub</a>
</div>
</div>
<p>This page have several state that encoded in the url:</p>

<ul>
<li>Page title have a default value, but if provided with a <code>title</code> query string, it will use that value</li>
<li>The edit panel can be open, or closed based on having the <code>panel</code> query string or not</li>
</ul>

<p><code>web.Location(url.Values{&#34;panel&#34;: []string{&#34;1&#34;}}).MergeQuery(true)</code> means it will do a push state request to current page, with panel query string panel=1.
<code>MergeQuery</code> means that it will not touch other query strings like <code>title=1</code> we mentioned above.</p>

<p>In <code>update5</code> event func, which is when you click the update button after open the panel, <code>web.Location(url.Values{&#34;panel&#34;: []string{&#34;&#34;}}).MergeQuery(true)</code> basically removes the query string panel=1, and won&#39;t touch any other query strings.</p>

<p>Don&#39;t have to be in event func to use push state query, can use a simple <code>web.Bind</code> to directly change the query string like:</p>

<div class="highlight highlight-go"><pre>A().Text(&#34;change page title&#34;).Href(&#34;javascript:;&#34;).
	Attr(&#34;@click&#34;, web.POST().Queries(url.Values{&#34;title&#34;: []string{&#34;Hello&#34;}}).Go()),
</pre></div>

<p>This don&#39;t have <code>.MergeQuery(true)</code>, So it will replace the whole query string to only <code>title=Hello</code></p>
</div>
</div>
</div>

<div class='font-medium text-base hidden xl:block text-gray-600 pt-4'>
<div class='sticky top-4 w-52'>On This Page<toc></toc></div>
</div>
</div>
<search-result></search-result></main>
</div>
</div>
</div>
</div>
</body>
</html>
