<!DOCTYPE html>

<html>
<head>
<title>Advanced Functions - Switch Pages with Push State - My Document</title>

<meta name='description'>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<base href='/docs/'>

<link href='index.css' rel='stylesheet' type='text/css'>

<script type='text/javascript' defer src='index.js'></script>
</head>

<body>
<div id='app' v-cloak>
<div v-init-context:vars='{hideAside: false}' class='flex h-screen'>
<div class='flex-1 flex flex-col overflow-hidden'>
<div class='flex h-full'>
<aside v-show='!vars.hideAside' class='flex flex-col w-80 h-full bg-gray-50 border-r border-gray-200 overflow-y-auto'>
<div class='h-12'><search></search></div>

<ul class='px-0 mx-0 text-base font-normal list-none text-gray-700'>
<li>
<a href='index.html' class='inline-block px-4 truncate break-words w-64 text-gray-700'>Introduction</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Getting Started</li>

<li>
<a href='getting-started/one-minute-quick-start.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>1 Minute Quick Start</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Basics</li>

<li>
<a href='basics/listing.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Listing Page</a>
</li>

<li>
<a href='basics/filter.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Filters</a>
</li>

<li>
<a href='presets-guide/editing-customizations.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Editing Customizations</a>
</li>

<li>
<a href='basics/form-handling.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Form Handling</a>
</li>

<li>
<a href='vuetify-components/basic-inputs.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Basic Inputs</a>
</li>

<li>
<a href='vuetify-components/auto-complete.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Auto Complete</a>
</li>

<li>
<a href='basics/shortcut.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Keyboard Shortcut</a>
</li>

<li>
<a href='vuetify-components/variant-sub-form.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Variant Sub Form</a>
</li>

<li>
<a href='vuetify-components/linkage-select.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Linkage Select</a>
</li>

<li>
<a href='presets-guide/permissions.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Permissions</a>
</li>

<li>
<a href='basics/notification-center.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Notification Center</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Advanced Functions</li>

<li>
<a href='basics/page-func-and-event-func.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Page Func and Event Func</a>
</li>

<li>
<a href='advanced-functions/the-go-html-builder.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>The Go HTML builder</a>
</li>

<li>
<a href='vuetify-components/a-taste-of-using-vuetify-in-go.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>A Taste of using Vuetify in Go</a>
</li>

<li>
<a href='presets-guide/its-the-whole-house.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Not just scaffolding, it&#39;s the whole house</a>
</li>

<li>
<a href='vuetify-components/navigation-drawer.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Navigation Drawer</a>
</li>

<li>
<a href='vuetify-components/lazy-portals.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Lazy Portals</a>
</li>

<li>
<a href='basics/layout-function-and-page-injector.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Layout Function and Page Injector</a>
</li>

<li>
<a href='basics/switch-pages-with-push-state.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-blue-500'>Switch Pages with Push State</a>
</li>

<li>
<a href='basics/reload-page-with-a-flash.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Reload Page with a Flash</a>
</li>

<li>
<a href='basics/partial-refresh-with-portal.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Partial Refresh with Portal</a>
</li>

<li>
<a href='basics/manipulate-page-url-in-event-func.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Manipulate Page URL in Event Func</a>
</li>

<li>
<a href='basics/summary-of-event-response.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Summary of Event Response</a>
</li>

<li>
<a href='basics/scope-component.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Scope Component</a>
</li>

<li>
<a href='basics/event-handling.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Event Handling</a>
</li>

<li>
<a href='presets-guide/detail-page-for-complex-object.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Detail page for complex object</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Digging Deeper</li>

<li>
<a href='components-guide/composite-new-component-with-go.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Composite new Component With Go</a>
</li>

<li>
<a href='components-guide/integrate-a-heavy-vue-component.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>Integrate a heavy Vue Component</a>
</li>

<li class='cursor-default px-4 truncate break-words w-64'>Appendix</li>

<li>
<a href='appendix/all-demo-examples.html' class='inline-block pl-10 pr-4 truncate break-words w-64 text-gray-700'>All Demo Examples</a>
</li>
</ul>
</aside>

<main class='flex flex-col w-full bg-white overflow-x-hidden overflow-y-auto'>
<div id='docContentBox' class='flex flex-row w-full'>
<div class='flex flex-grow flex-col w-2/3'>
<div class='flex flex-row'>
<button @click='vars.hideAside = !vars.hideAside' class='w-12 h-12 p-4'>
<div class='w-4 h-4 fill-current text-gray-300'>
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 2 12 L 2 11 L 14 11 L 14 12 Z M 2 8.5 L 2 7.5 L 14 7.5 L 14 8.5 Z M 2 5 L 2 4 L 14 4 L 14 5 Z M 2 5 "/>
</g>
</svg>
</div>
</button>
</div>

<div id='docMainBox' class='px-16 pb-12 pt-4 overflow-auto'>
<h1 class='mb-8'>Switch Pages with Push State</h1>

<div class='border-t'><p>Ways that page transition (between <code>web.PageFunc</code>) in QOR5 web app:</p>

<ul>
<li>Use a traditional link to a new page by url</li>
<li>Use a push state link to a new page that only change the current page body to new page body and browser url</li>
<li>Use a button etc to trigger post to an <code>web.EventFunc</code> that do some logic, then go to a new page</li>
</ul>

<p>Inside <code>web.EventFunc</code>, two ways go to a new page:</p>

<ul>
<li>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API#Examples" rel="nofollow">push state</a> to only reload the body of the new page, This won&#39;t reload javascript and css assets.</li>
<li>Use redirect url to reload the whole new page, This will reload target new page&#39;s javascript and css assets.</li>
</ul>

<p>This example demonstrated the above:</p>

<highlightjs :language='"go"' :code='"\nconst Page1Path = \"/samples/page_1\"\nconst Page2Path = \"/samples/page_2\"\n\nfunc Page1(ctx *web.EventContext) (pr web.PageResponse, err error) {\n\tpr.Body = Div(\n\t\tH1(page1Title),\n\t\tUl(\n\t\t\tLi(\n\t\t\t\tA().Href(Page2Path).\n\t\t\t\t\tText(\"To Page 2 With Normal Link\"),\n\t\t\t),\n\t\t\tLi(\n\t\t\t\tA().Href(\"javascript:;\").\n\t\t\t\t\tText(\"To Page 2 With Push State Link\").\n\t\t\t\t\tAttr(\"@click\", web.POST().PushStateURL(Page2Path).Go()),\n\t\t\t),\n\t\t),\n\t\tfromParam(ctx),\n\t).Style(\"color: green; font-size: 24px;\")\n\treturn\n}\n\nfunc Page2(ctx *web.EventContext) (pr web.PageResponse, err error) {\n\n\tpr.Body = Div(\n\t\tH1(\"Page 2\"),\n\t\tUl(\n\t\t\tLi(\n\t\t\t\tA().Href(\"javascript:;\").\n\t\t\t\t\tText(\"To Page 1 With Normal Link\").\n\t\t\t\t\tAttr(\"@click\", web.POST().\n\t\t\t\t\t\tPushStateURL(Page1Path).\n\t\t\t\t\t\tQueries(url.Values{\"from\": []string{\"page 2 link 1\"}}).\n\t\t\t\t\t\tGo()),\n\t\t\t),\n\t\t\tLi(\n\t\t\t\tButton(\"Do an action then go to Page 1 with push state and parameters\").\n\t\t\t\t\tAttr(\"@click\", web.POST().EventFunc(\"doAction2\").Query(\"id\", \"42\").Go()),\n\t\t\t),\n\t\t\tLi(\n\t\t\t\tButton(\"Do an action then go to Page 1 with redirect url\").\n\t\t\t\t\tAttr(\"@click\", web.POST().EventFunc(\"doAction1\").Query(\"id\", \"41\").Go()),\n\t\t\t),\n\t\t),\n\t).Style(\"color: orange; font-size: 24px;\")\n\treturn\n}\n\nfunc fromParam(ctx *web.EventContext) HTMLComponent {\n\tvar from HTMLComponent\n\tval := ctx.R.FormValue(\"from\")\n\tif len(val) \u003e 0 {\n\t\tfrom = Components(\n\t\t\tB(\"from:\"),\n\t\t\tText(val),\n\t\t)\n\t}\n\treturn from\n}\n\nfunc doAction1(ctx *web.EventContext) (er web.EventResponse, err error) {\n\tupdateDatabase(ctx.QueryAsInt(\"id\"))\n\ter.RedirectURL = Page1Path + \"?\" + url.Values{\"from\": []string{\"page2 with redirect\"}}.Encode()\n\treturn\n}\n\nfunc doAction2(ctx *web.EventContext) (er web.EventResponse, err error) {\n\tupdateDatabase(ctx.QueryAsInt(\"id\"))\n\ter.PushState = web.Location(url.Values{\"from\": []string{\"page2\"}}).\n\t\tURL(Page1Path)\n\treturn\n}\n\nvar Page1PB = web.Page(Page1)\n\nvar Page2PB = web.Page(Page2).\n\tEventFunc(\"doAction1\", doAction1).\n\tEventFunc(\"doAction2\", doAction2)\n"'></highlightjs>

<div>
<div class='demo'>
<a href='/samples/page_1' target='_blank'>Check the demo</a>
 | 
<a href='https://github.com/qor5/docs/tree/master/examples/e00_basics/page-transition.go' target='_blank'>Source on GitHub</a>
</div>
</div>
<p>When running the above demo, If you check Chrome Developer Tools about Network requests,
You will see that the Location link and the Button is actually doing an AJAX request to the other page.</p>

<p>Look like this:</p>

<pre><code>POST /samples/page_2?__execute_event__=__reload__ HTTP/1.1
</code></pre>

<p>The result is an JSON object with page&#39;s html inside.
<code>__reload__</code> is another <code>web.EventFunc</code> that is the same as <code>doAction2</code>,
But it is default added to every <code>web.PageFunc</code>. So that the web page can
both respond to normal HTTP request from Browser, Search Engine, Or from
other pages in the same web app that can do push state link.</p>

<h2 id='summary'>Summary
<a href='#summary' class='anchor'></a>
</h2>
<ul>
<li>Write once with PageFunc, you get both normal html page render, and AJAX JSON page render</li>
<li>EventFunc is always called with AJAX request, and you can return to a different page, or rerender the current page,</li>
<li>EventFunc is not wrapped with layout function.</li>
<li>EventFunc is used to do data operations, triggered by page&#39;s html element. and it&#39;s result can be:

<ol>
<li>Go to a new page</li>
<li>Reload the whole current page</li>
<li>Update partial of the current page</li>
</ol></li>
</ul>

<p>Next we will talk about how to reload the whole current page, and update partial of the current page.</p>
</div>
</div>
</div>

<div class='font-medium text-base hidden xl:block text-gray-600 pt-4'>
<div class='sticky top-4 w-52'>On This Page<toc></toc></div>
</div>
</div>
<search-result></search-result></main>
</div>
</div>
</div>
</div>
</body>
</html>
